# Mihomo 完整配置：国内直连 + 国外自动代理（AI、社交、流媒体、游戏娱乐）

proxies:
  - {name: "直连", type: direct}
  - {name: "拒绝", type: reject}
  - name: "美国S"
    type: vmess
    server: s.psmeme.xyz
    port: 34168
    uuid: af354ba3-dc2b-4864-c22e-a3e3f0238c79
    alterId: 0
    cipher: auto
    tls: true
    network: tcp
    udp: true
  - name: "美国D"
    type: vmess
    server: d.psmeme.xyz
    port: 34011
    uuid: f82ae050-12d4-4f65-9f5b-6d9ab5d4d17d
    alterId: 0
    cipher: auto
    tls: true
    network: tcp
    udp: true

proxy-groups:
  - name: "美国-主故障转移"
    type: fallback
    proxies:
      - 美国S
      - 美国D
    interval: 300
    lazy: true

  - name: "国外"
    type: url-test
    proxies:
      - 美国S
      - 美国D
    url: https://www.gstatic.com/generate_204
    interval: 300
    tolerance: 100

  - name: "AI"
    type: select
    proxies:
      - 国外
      - 美国-主故障转移

  - name: "社交媒体"
    type: select
    proxies:
      - 国外
      - 美国-主故障转移

  - name: "流媒体"
    type: select
    proxies:
      - 国外
      - 美国-主故障转移

  - name: "游戏娱乐"
    type: select
    proxies:
      - 国外
      - 美国-主故障转移

  - name: "默认"
    type: select
    proxies:
      - 国外
      - 美国-主故障转移
      - 直连
      - 拒绝

port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
allow-lan: true
mode: rule
log-level: info
external-controller: 127.0.0.1:9090
secret: "123456"

dns:
  enable: true
  listen: 0.0.0.0:7874
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.20.0.1/16
  nameserver:
    - 223.5.5.5
    - 1.1.1.1
  fake-ip-filter:
    - "+.lan"
    - "+.local"
    - geosite:cn

rule-providers:
  Google:
    type: http
    behavior: domain
    format: yaml
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.yaml
    interval: 86400
  YouTube:
    type: http
    behavior: domain
    format: yaml
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml
    interval: 86400
  ChatGPT:
    type: http
    behavior: domain
    format: yaml
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI.yaml
    interval: 86400
  Netflix:
    type: http
    behavior: domain
    format: yaml
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.yaml
    interval: 86400
  Disney:
    type: http
    behavior: domain
    format: yaml
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Disney/Disney.yaml
    interval: 86400
  Telegram:
    type: http
    behavior: domain
    format: yaml
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml
    interval: 86400
  Facebook:
    type: http
    behavior: domain
    format: yaml
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Facebook/Facebook.yaml
    interval: 86400
  Twitter:
    type: http
    behavior: domain
    format: yaml
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Twitter/Twitter.yaml
    interval: 86400
  Reddit:
    type: http
    behavior: domain
    format: yaml
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Reddit/Reddit.yaml
    interval: 86400

rules:
  - RULE-SET,Google,AI
  - RULE-SET,ChatGPT,AI
  - RULE-SET,YouTube,流媒体
  - RULE-SET,Netflix,流媒体
  - RULE-SET,Disney,流媒体
  - RULE-SET,Telegram,社交媒体
  - RULE-SET,Facebook,社交媒体
  - RULE-SET,Twitter,社交媒体
  - RULE-SET,Reddit,社交媒体
  - DOMAIN-SUFFIX,cn,直连
  - GEOIP,CN,直连
  - MATCH,默认